# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏ –≤ Diogen Chat Widget

## –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:

### 1. –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏
**–ë—ã–ª–æ:** –ó–∞–ø—É—Ç–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ—Ä—Ç–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –≤–Ω–µ—à–Ω–∏—Ö CORS –ø—Ä–æ–∫—Å–∏
**–°—Ç–∞–ª–æ:** –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ - –ø—Ä–æ–∫—Å–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è localhost

### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
**–ë—ã–ª–æ:** –°–º–µ—à–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å `isLocalhost` –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
**–°—Ç–∞–ª–æ:** –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ - `X-TOKEN` –¥–ª—è –ø—Ä–æ–∫—Å–∏, `Authorization` –¥–ª—è –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
**–ë—ã–ª–æ:** –ù–µ—Ç–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö CORS
**–°—Ç–∞–ª–æ:** –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### `shouldUseProxy()` - —É–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞
```javascript
shouldUseProxy() {
    const isLocalhost = window.location.hostname === 'localhost';
    console.log(`[Diogen] Hostname: ${window.location.hostname}, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–∫—Å–∏: ${isLocalhost}`);
    return isLocalhost;
}
```

### `generateProxyUrl()` - –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏
```javascript
generateProxyUrl() {
    return '/api/proxy';
}
```

### `callChatAPI()` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏
- **–î–ª—è –ø—Ä–æ–∫—Å–∏ (localhost):** `X-Target-URL` –∏ `X-TOKEN`
- **–î–ª—è –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (production):** `Authorization`

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **Localhost (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞):** 
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Vite –ø—Ä–æ–∫—Å–∏ `/api/proxy`
   - –ó–∞–≥–æ–ª–æ–≤–∫–∏: `X-Target-URL` –∏ `X-TOKEN`

2. **Production:**
   - –ü—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API
   - –ó–∞–≥–æ–ª–æ–≤–æ–∫: `Authorization: Basic ...`

## –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã:

- ‚úÖ `widget/diogen-chat-widget.js` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
- ‚úÖ `netlify/functions/proxy.js` - —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ Basic Auth
- ‚úÖ `widget/test-improved-proxy.html` - —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

–û—Ç–∫—Ä–æ–π—Ç–µ `widget/test-improved-proxy.html` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Netlify —Ñ—É–Ω–∫—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä—è–º–æ–≥–æ API

## –†–µ–∑—É–ª—å—Ç–∞—Ç:

- üéØ –ü—Ä–æ—Å—Ç–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞
- üîí –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- üöÄ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö
- üìù –ß–µ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö 